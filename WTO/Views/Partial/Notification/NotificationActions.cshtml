@model BusinessObjects.Notification.NotificationActions
@{
    Layout = null;
}
<script src="~/JQuery/Notification_PartialPages.js?v=6"></script>

<div class="panel-heading" role="tab" id="headingfive">
    <h4 class="panel-title Accordian-panel-title">
        <a class="collapsed" role="button" data-toggle="collapse" data-parent="#accordion" href="#collapsefive" aria-expanded="false" aria-controls="collapsefive">
            <i class="more-less glyphicon glyphicon-chevron-down"></i>
            Actions
        </a>
    </h4>
</div>
<div id="collapsefive" class="panel-collapse collapse in" role="tabpanel" aria-labelledby="headingfive">
    <div class="panel-body Accordian-body">
        <div>
            <div class="col-xs-12 col-sm-12 col-md-12 whitebackground padding-bottom-10 full-border">
                <div class="row top-offset-30">
                    <div class="col-xs-12 col-sm-8 col-md-8">
                        <p class="wto-label-normal top-offset-10 @(Model.MeetingDate==""?"hidden":"")">
                            Discussed in Meeting on <span class="wto-label-bold" id="lblDiscussedOn">@Model.MeetingDate</span>
                            @if (Model.RetainedForNextDiscussion)
                            {
                                @("and retained for next meeting")
                            }
                        </p>
                    </div>
                    @if (Model.IsUpdate)
                    {
                        <div class="col-xs-12 col-sm-4 col-md-4">
                            <a class="btn btn-dark-green pull-right @((Model.Actions != null && Model.Actions.FirstOrDefault(x => ((x.ActionId <4 && x.MailId <=0) || (x.ActionId==4 && x.UpdatedOn!=""))) != null) ? "" : "hidden")" data-SearchFor="@Model.NotificationId" style="margin-right:15px;" id="btnplanAction" onclick="return EditNotificationActions(this);">Plan action</a>
                        </div>
                    }
                </div>
                <div class="row top-offset-20">
                    <div class="col-xs-12 col-sm-12 col-md-12">
                        <div class="table-responsive nopaging notificationlist sentmail">
                            @if (Model.Actions != null && Model.Actions.Sum(x => x.NotificationActionId) > 0)
                            {
                                <table class="table table-bordered display" id="notificationlist" cellspacing="0" width="100%">
                                    <thead class="second-blackbackground">
                                        <tr>
                                            <th>Action</th>
                                            <th class="text-center @(Model.Actions.FirstOrDefault(x => (x.ActionId==4 && x.UpdatedOn!=""))!=null?"hidden":"")">Required by</th>
                                            <th class="text-center">Completed on</th>
                                            <th>&nbsp;</th>
                                        </tr>
                                    </thead>
                                    <tbody class="whitebackground">
                                        @foreach (BusinessObjects.Notification.NotificationActionDetail ac in Model.Actions)
                                        {
                                            if (@ac.NotificationActionId > 0)
                                            {
                                                <tr>
                                                    <td>@ac.Action</td>
                                                    <td class="text-center @(Model.Actions.FirstOrDefault(x => (x.ActionId==4 && x.UpdatedOn!=""))!=null?"hidden":"")" id="tdRequiredOn_@ac.NotificationActionId">@ac.RequiredOn</td>
                                                    <td class="text-center">@((ac.MailId > 0 || ac.ActionId == 4) ? ac.UpdatedOn : "")</td>
                                                    @if (ac.MailId == 0)
                                                    {
                                                        <td>
                                                            @if (ac.ActionId != 4)
                                                            {
                                                                <span><a data-toggle="modal" data-SearchFor="@ac.Action" data-callfor="editaction" onclick="EditAction(@ac.NotificationActionId,this);"><img src="~/contents/img/bedit.png" alt="edit" /></a></span>
                                                            }
                                                            <input type="hidden" id="hdnDraftRegulationBrief_@ac.NotificationActionId" value="@ac.DraftRegulationBrief" />
                                                            <input type="hidden" id="hdnReferencetoInternationalStandards_@ac.NotificationActionId" value="@ac.ReferencetoInternationalStandards" />
                                                            <input type="hidden" id="hdnTradeData_@ac.NotificationActionId" value="@ac.TradeData" />
                                                            <input type="hidden" id="hdnImplications_@ac.NotificationActionId" value="@ac.Implications" />
                                                            <input type="hidden" id="hdnActionId_@ac.NotificationActionId" value="@ac.ActionId" />
                                                        </td>
                                                    }
                                                    else
                                                    {
                                                        <td>
                                                            @if (ac.ActionId != 4)
                                                            {
                                                                <span><a data-SearchId="@ac.ActionId" data-SearchFor="@ac.Action" onclick="ViewAction(@ac.NotificationActionId,this);"><i class="glyphicon glyphicon-eye-open" aria-hidden="true"></i></a></span>
                                                            }
                                                            <input type="hidden" id="hdnDraftRegulationBrief_@ac.NotificationActionId" value="@ac.DraftRegulationBrief" />
                                                            <input type="hidden" id="hdnReferencetoInternationalStandards_@ac.NotificationActionId" value="@ac.ReferencetoInternationalStandards" />
                                                            <input type="hidden" id="hdnTradeData_@ac.NotificationActionId" value="@ac.TradeData" />
                                                            <input type="hidden" id="hdnImplications_@ac.NotificationActionId" value="@ac.Implications" />
                                                            <input type="hidden" id="hdnActionId_@ac.NotificationActionId" value="@ac.ActionId" />
                                                        </td>
                                                    }
                                                </tr>
                                            }
                                        }
                                    </tbody>
                                </table>
                            }
                        </div>
                    </div>
                </div>
                <div class="row">
                    @if (Model.MeetingDate != "")
                    {
                        <div class="col-xs-12 col-sm-4 col-md-2">
                            <p class="wto-label-bold"><a onclick="OpenAddNote()">Note</a></p>
                        </div>
                        <div class="col-xs-12 col-sm-8 col-md-10">
                            <p class="wto-label-normal" id="MeetingNoteId">@(Model.MeetingNotes.Length > 40 ? Model.MeetingNotes.Substring(0, 39) + ".." : Model.MeetingNotes)</p>
                        </div>
                    }
                </div>
            </div>
        </div>
    </div>
</div>

<!--Action checkbox popup-->
@{ Html.RenderAction("GetNotificationPlanTakeAction", "AddNotification", new { Id = Model.NotificationId }); }

<div class="modal fade selecthrmodal" id="ViewActionModal" role="dialog" data-backdrop="static" data-keyboard="false">
    <div class="modal-dialog modal-lg selecthrdialog">
        <div class="modal-content selecthrcontent">
            <div class="modal-header selecthrheader">
                <button type="button" class="close selecthrclose" data-dismiss="modal">
                    <span class="glyphicon glyphicon-remove"></span>
                </button>
            </div>
            <div class="modal-body selecthrbody">
                <div class="row">
                    <div class="col-xs-12 col-sm-12 col-md-12">
                        <div class="col-xs-12 col-sm-12 col-md-12 selecthrbodyinner">
                            <div class="col-xs-12 col-sm-12 col-md-12 top-offset-10">
                                <div class="notificationnumber padding-bottom-10">
                                    <div class="row">
                                        <div class="col-xs-12 col-sm-12 col-md-12">
                                            <h4 class="selecthrheading2"><span class="ActionName"></span></h4>
                                        </div>
                                    </div>
                                </div>
                                <div class="top-offset-10">
                                    <div class="row top-offset-10">
                                        <div class="col-xs-12 col-sm-4 col-md-4">
                                            <p class="wto-label-normal"><b>Notification Number</b> <span class="pull-right">:</span></p>
                                        </div>
                                        <div class="col-xs-12 col-sm-8 col-md-8">
                                            <p class="wto-label-normal">@Model.NotificationNumber</p>
                                        </div>
                                    </div>
                                    <div class="row top-offset-10">
                                        <div class="col-xs-12 col-sm-4 col-md-4">
                                            <p class="wto-label-normal"><b>Title</b> <span class="pull-right">:</span></p>
                                        </div>
                                        <div class="col-xs-12 col-sm-8 col-md-8">
                                            <p class="wto-label-normal WordWrapText">@Model.NotificationTitle</p>
                                        </div>
                                    </div>
                                    <div class="row top-offset-10">
                                        <div class="col-xs-12 col-sm-4 col-md-4">
                                            <p class="wto-label-normal"><b>Meeting Date</b><span class="pull-right">:</span></p>
                                        </div>
                                        <div class="col-xs-12 col-sm-8 col-md-8">
                                            <p class="wto-label-normal" id="txtMeetingDate">@Model.MeetingDate</p>
                                        </div>
                                    </div>
                                    <div class="row top-offset-10">
                                        <div class="col-xs-12 col-sm-4 col-md-4">
                                            <p class="wto-label-normal"><b>Action Due on</b><span class="pull-right">:</span></p>
                                        </div>
                                        <div class="col-xs-12 col-sm-8 col-md-8">
                                            <p class="wto-label-normal" id="lblActionDueOn"></p>
                                        </div>
                                    </div>
                                    <div class="row top-offset-10">
                                        <div class="col-xs-12 col-sm-4 col-md-4">
                                            <p class="wto-label-normal"><b>Action taken on</b><span class="pull-right">:</span></p>
                                        </div>
                                        <div class="col-xs-12 col-sm-8 col-md-8">
                                            <p class="wto-label-normal" id="lblActionTakenOn"></p>
                                        </div>
                                    </div>
                                    <div class="row top-offset-10">
                                        <div class="col-xs-12 col-sm-4 col-md-4">
                                            <p class="wto-label-normal"><b>Recipients</b><span class="pull-right">:</span></p>
                                        </div>
                                        <div class="col-xs-12 col-sm-8 col-md-8">
                                            <p class="wto-label-normal WordWrapText" id="lblRecipients"></p>
                                        </div>
                                    </div>
                                    <div class="row top-offset-10">
                                        <div class="col-xs-12 col-sm-4 col-md-4">
                                            <p class="wto-label-normal"><b>Mail Subject</b><span class="pull-right">:</span></p>
                                        </div>
                                        <div class="col-xs-12 col-sm-8 col-md-8">
                                            <p class="wto-label-normal WordWrapText" id="lblMailSubject"></p>
                                        </div>
                                    </div>
                                    <div class="row top-offset-10">
                                        <div class="col-xs-12 col-sm-4 col-md-4">
                                            <p class="wto-label-normal"><b>Message</b><span class="pull-right">:</span></p>
                                        </div>
                                        <div class="col-xs-12 col-sm-8 col-md-8">
                                            <p class="wto-label-normal" id="lblMailMessage"></p>
                                            <p class="wto-label-normal" id="lblMailAttachments"></p>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!--start section For Print Div-->
                            <div class="col-xs-12 col-sm-12 col-md-12" id="prntDiv" style="display:none;">
                                <div class="notificationnumber padding-bottom-10">
                                    <div class="row">
                                        <div class="col-xs-12 col-sm-12 col-md-12">
                                            <h4 class="selecthrheading2"><span class="ActionName"></span></h4>
                                        </div>
                                    </div>
                                </div>
                                <div class="top-offset-10">
                                    <div class="row top-offset-10">
                                        <div class="col-md-12 col-sm-12 col-xs-12">
                                            <table id="tblViewAction" class="table-responsive">
                                                <tr>
                                                    <td><b>Notification Number</b></td>
                                                    <td>:</td>
                                                    <td>@Model.NotificationNumber</td>
                                                </tr>
                                                <tr>
                                                    <td><b>Title</b></td>
                                                    <td>:</td>
                                                    <td>@Model.NotificationTitle</td>
                                                </tr>
                                                <tr>
                                                    <td><b>Meeting Date</b></td>
                                                    <td>:</td>
                                                    <td><span id="txtMeetingDate1">@Model.MeetingDate</span></td>
                                                </tr>
                                                <tr>
                                                    <td><b>Action Due on</b></td>
                                                    <td>:</td>
                                                    <td><span id="lblActionDueOn1"></span></td>
                                                </tr>
                                                <tr>
                                                    <td><b>Action taken on</b></td>
                                                    <td>:</td>
                                                    <td><span id="lblActionTakenOn1"></span></td>
                                                </tr>
                                                <tr>
                                                    <td><b>Recipients</b></td>
                                                    <td>:</td>
                                                    <td><span class="WordWrapText" id="lblRecipients1"></span></td>
                                                </tr>
                                                <tr>
                                                    <td><b>Mail Subject</b></td>
                                                    <td>:</td>
                                                    <td><span class="WordWrapText" id="lblMailSubject1"></span></td>
                                                </tr>
                                                <tr>
                                                    <td><b>Message</b></td>
                                                    <td>:</td>
                                                    <td>
                                                        <span id="lblMailMessage1"></span>
                                                        @*<span id="lblMailAttachments1"></span>*@
                                                    </td>
                                                </tr>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <!--End section For Print Div-->

                            <div class="col-xs-12 col-sm-12 col-md-12 top-offset-20 bottom-offset-20">
                                <div class="row">
                                    <div class="col-xs-12 col-sm-12 col-md-12">
                                        <a class="btn btn-red btn-padding pull-right left-offset-10" onclick="return CloseViewAction();" id="lnkClose">Close</a>
                                        <a class="btn btn-dark-green pull-right btn-padding" onclick="return printDiv('prntDiv');" id="btnPrint">Print</a>
                                    </div>
                                </div>
                            </div>

                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>




<!-- edit meeting note modal popup -->
<div class="modal fade selecthrmodal" id="AddNote" role="dialog" data-backdrop="static" data-keyboard="false">
    @{ Html.RenderAction("GetNotificatioNote", "AddNotification", new { Id = @Model.NotificationId }); }
</div>
<!-- edit meeting note modal popup -->
