using System;
using System.Data;
using System.Data.SqlClient;
using BusinessObjects;
using BusinessObjects.Notification;
using UtilitiesManagers;

namespace DataServices.WTO
{
    public class AddNotificationDataManager
    {
        public DataSet InsertUpdate_Notification(AddNotification obj)
        {
            using (SqlCommand sqlCommand = new SqlCommand())
            {
                sqlCommand.CommandType = CommandType.StoredProcedure;
                sqlCommand.CommandText = Procedures.Notification_AddUpdate;
                sqlCommand.Parameters.AddWithValue("@UserId", obj.UserId);
                sqlCommand.Parameters.AddWithValue("@NotificationId", obj.NotificationId);
                sqlCommand.Parameters.AddWithValue("@NotificationType", obj.NotificationType);
                sqlCommand.Parameters.AddWithValue("@NotificationNumber", obj.NotificationNumber);
                sqlCommand.Parameters.AddWithValue("@NotificationStatus", obj.NotificationStatus);
                sqlCommand.Parameters.AddWithValue("@DateOfNotification", obj.DateofNotification);
                sqlCommand.Parameters.AddWithValue("@DateOfComments", obj.FinalDateOfComments);
                sqlCommand.Parameters.AddWithValue("@SendResponseBy", obj.SendResponseBy);
                sqlCommand.Parameters.AddWithValue("@CountryId", obj.CountryId);
                sqlCommand.Parameters.AddWithValue("@Title", obj.Title);
                sqlCommand.Parameters.AddWithValue("@ResponsibleAgency", obj.ResponsibleAgency);
                sqlCommand.Parameters.AddWithValue("@UnderArticle", obj.UnderArticle);
                sqlCommand.Parameters.AddWithValue("@ProductsCovered", obj.ProductsCovered);
                sqlCommand.Parameters.AddWithValue("@HSCodes", obj.HSCodes);
                sqlCommand.Parameters.AddWithValue("@Description", obj.Description);
                sqlCommand.Parameters.AddWithValue("@EnquiryEmail", obj.EnquiryEmail);
                sqlCommand.Parameters.AddWithValue("@DoesHaveDetails", obj.DoesHaveDetails);
                if (obj.NotificationAttachment != null)
                    sqlCommand.Parameters.AddWithValue("@NotificationAttachment", obj.NotificationAttachment.FileName);
                if (obj.NotificationDoc != null)
                {
                    sqlCommand.Parameters.AddWithValue("@NotificationDocument", obj.NotificationDoc.FileName);
                    sqlCommand.Parameters.AddWithValue("@NotificationDocumentName", obj.NotificationDoc.DisplayName);
                }
                sqlCommand.Parameters.AddWithValue("@LanguageId ", obj.LanguageId);
                sqlCommand.Parameters.AddWithValue("@ObtainDocBy", obj.ObtainDocBy);
                sqlCommand.Parameters.AddWithValue("@StakeholderResponseDueBy", obj.StakeholderResponseDueBy);
                if (obj.TranslatedDoc != null)
                {
                    sqlCommand.Parameters.AddWithValue("@TranslatedDocument", obj.TranslatedDoc.FileName);
                    sqlCommand.Parameters.AddWithValue("@TranslatedDocumentName", obj.TranslatedDoc.DisplayName);
                    sqlCommand.Parameters.AddWithValue("@Role", obj.Role);
                }
                return DAL.GetDataSet(ConfigurationHelper.connectionString, sqlCommand);
            }
        }

        public DataSet Edit_Notification(Int64 Id)
        {
            using (SqlCommand sqlCommand = new SqlCommand())
            {
                sqlCommand.CommandType = CommandType.StoredProcedure;
                sqlCommand.CommandText = Procedures.Notification_Edit;
                sqlCommand.Parameters.AddWithValue("@NotificationId", Id);
                return DAL.GetDataSet(ConfigurationHelper.connectionString, sqlCommand);
            }
        }

        public DataTable RelatedStakeholders(Int64 Id)
        {
            using (SqlCommand sqlCommand = new SqlCommand())
            {
                sqlCommand.CommandType = CommandType.StoredProcedure;
                sqlCommand.CommandText = Procedures.Notification_RelatedStakeholders;
                sqlCommand.Parameters.AddWithValue("@NotificationId", Id);
                return DAL.GetDataTable(ConfigurationHelper.connectionString, sqlCommand);
            }
        }

        public DataTable InsertDelete_RelatedStakeholders(Int64 Id, string SelectedStakeHolder, bool IsDelete)
        {
            using (SqlCommand sqlCommand = new SqlCommand())
            {
                sqlCommand.CommandType = CommandType.StoredProcedure;
                sqlCommand.CommandText = Procedures.Notification_AddRemoveRelatedStakeholders;
                sqlCommand.Parameters.AddWithValue("@NotificationId", Id);
                sqlCommand.Parameters.AddWithValue("@SelectedStakeHolder", SelectedStakeHolder);
                sqlCommand.Parameters.AddWithValue("@IsDelete", IsDelete);
                return DAL.GetDataTable(ConfigurationHelper.connectionString, sqlCommand);
            }
        }

        public DataTable SendDocumentToTranslater(SendToTranslater obj)
        {
            using (SqlCommand sqlCommand = new SqlCommand())
            {
                sqlCommand.CommandType = CommandType.StoredProcedure;
                sqlCommand.CommandText = Procedures.Notification_SendToTranslate;
                sqlCommand.Parameters.AddWithValue("@NotificationId", obj.NotificationId);
                sqlCommand.Parameters.AddWithValue("@DoesHaveDetails", obj.DoesHaveDetails);
                sqlCommand.Parameters.AddWithValue("@NotificationDocument", obj.NotificationDoc.FileName);
                sqlCommand.Parameters.AddWithValue("@NotificationDocumentName", obj.NotificationDoc.DisplayName);
                sqlCommand.Parameters.AddWithValue("@LanguageId", obj.LanguageId);
                sqlCommand.Parameters.AddWithValue("@TranslatorId", obj.TranslaterId);
                sqlCommand.Parameters.AddWithValue("@TranslationDueOn", obj.TranslationDueOn);
                sqlCommand.Parameters.AddWithValue("@TranslationReminderOn", obj.TranslationReminderOn);
                return DAL.GetDataTable(ConfigurationHelper.connectionString, sqlCommand);
            }
        }

        public DataSet SendMailToStakeHolders(SendMailStakeholders obj)
        {
            using (SqlCommand sqlCommand = new SqlCommand())
            {
                sqlCommand.CommandType = CommandType.StoredProcedure;
                sqlCommand.CommandText = Procedures.Notifiaction_SendMailToStakeholders;
                sqlCommand.Parameters.AddWithValue("@UserId", obj.UserId);
                sqlCommand.Parameters.AddWithValue("@NotificationId", obj.NotificationId);
                sqlCommand.Parameters.AddWithValue("@Stakeholders", obj.Stakeholders);
                sqlCommand.Parameters.AddWithValue("@Subject", obj.Subject);
                sqlCommand.Parameters.AddWithValue("@Message", obj.Message);
                return DAL.GetDataSet(ConfigurationHelper.connectionString, sqlCommand);
            }
        }
    }
}
